<script>
  // Ativa a câmera do celular como fundo
  const video = document.getElementById('cameraFeed');
  navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" }, audio: false })
    .then(function (stream) {
      video.srcObject = stream;
    })
    .catch(function (err) {
      console.error("Erro ao acessar a câmera: ", err);
    });

  // Espera a cena carregar
  document.querySelector('a-scene').addEventListener('loaded', function () {
    const quadro = document.getElementById('quadro');
    const camera = document.querySelector('[camera]');

    document.querySelector('a-scene').addEventListener('click', function () {
      // Pega a posição e direção da câmera
      const cameraEl = camera.object3D;
      const cameraPosition = new THREE.Vector3();
      const cameraDirection = new THREE.Vector3();

      cameraEl.getWorldPosition(cameraPosition);
      cameraEl.getWorldDirection(cameraDirection);

      // Calcula nova posição: 2 metros à frente
      const quadroPosition = cameraPosition.clone().add(cameraDirection.multiplyScalar(2));

      // Aplica a posição ao quadro
      quadro.setAttribute('position', {
        x: quadroPosition.x,
        y: quadroPosition.y,
        z: quadroPosition.z
      });

      quadro.setAttribute('visible', true);
    });
  });
</script>
